import{T as M,M as j,H as D}from"./components.b8cc7c2b.js";import{E as H}from"./index.8f5bc808.js";import{E as N}from"./el-progress.1eae7595.js";import{E as A,a as O}from"./el-tabs.1c3126a6.js";import"./base.c054e6db.js";/* empty css                  */import{v as P}from"./el-loading.b1ea91ae.js";import{d as q,r as s,k as x,l as $,q as o,s as l,v as p,m as a,z as h,A as k,B as E,E as G,C as J,F as K,x as Q,y as W,_ as X}from"./entry.89a8456c.js";import{p as Y,u as Z}from"./constants.0737b991.js";import{f as ee}from"./util.a9abac9b.js";import"./index.64d33a3b.js";import"./use-global-config.0787c757.js";import"./use-form-common-props.4add0763.js";import"./index.f8748455.js";import"./error.78e43d3e.js";import"./aria.60e0cdc6.js";import"./event.9519ab40.js";import"./vnode.76be746b.js";const g=r=>(Q("data-v-24e880a1"),r=r(),W(),r),te={style:{width:"90%",margin:"0 auto"}},ae={style:{width:"60%",margin:"0 auto","margin-top":"15%"}},oe=g(()=>a("div",{style:{"font-size":"24px",height:"50px"}},"模糊图片修复",-1)),se={style:{"margin-top":"10%","font-size":"24px"}},le=g(()=>a("div",{style:{color:"black"}},"或者拖放一个文件",-1)),ne={style:{width:"80%",margin:"0 auto","margin-top":"10%"}},ie={style:{float:"left",width:"45%",position:"relative"}},re={class:"cutout-image-container"},ce=["src"],de={class:"cutout-image-container"},pe=["src"],ue={style:{float:"right",width:"45%",height:"442px",margin:"0 auto"}},me=g(()=>a("div",{style:{height:"400px"}},null,-1)),_e={style:{width:"100%",margin:"0 auto"}},fe=q({__name:"repair",setup(r){const u=s(!0),c=s("before"),m=s(!0),B=s(),_=s(),w=s(),f=s(),d=s(""),y=s(),I=async t=>{u.value=!0,c.value="before",d.value="",B.value=t.raw,m.value=!1,w.value=await ee(t.raw),await T(t.raw)},T=async t=>{_.value=t;const e=new FormData;e.append("file",t),e.append("outscale",1),e.append("fe","true");const i=await(await fetch("http://124.220.44.98:5002/api/realesrgan",{method:"POST",body:e})).blob();f.value=URL.createObjectURL(i),u.value=!1,c.value="after"},z=t=>{const e=document.createElement("a");e.href=t,e.download=_.value.name,e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(()=>{e.remove()},100)},S=()=>{var t=new Image;t.src=f.value;let e=document.createElement("canvas"),n=e.getContext("2d");t.onload=()=>{e.width=t.width,e.height=t.height,d&&(n.fillStyle=d.value),n.fillRect(0,0,e.width,e.height),n.drawImage(t,0,0);var i=e.toDataURL(_.value.type);z(i)}},C=()=>{var t,e;(e=(t=y.value)==null?void 0:t.$.vnode.el)==null||e.click()};return(t,e)=>{const n=M,i=j,F=D,v=H,R=N,b=A,U=O,V=P;return x(),$(K,null,[o(F,null,{default:l(()=>[o(n,null,{default:l(()=>[p("模糊图片修复")]),_:1}),o(i,{name:"description",content:"老照片修复"}),o(i,{name:"keywords",content:"图片,修复, 老照片,清晰"})]),_:1}),a("div",te,[h(a("div",ae,[oe,a("div",null,[o(R,{class:"upload-demo",drag:"","show-file-list":!1,"auto-upload":!1,onChange:I,accept:".gif,.tif,.tiff,.png,.crw,.cr2,.dng,.raf,.nef,.nrw,.orf,.rw2,.pef,.arw,.srf,.sr2,.raw,.psd,.svg,.webp,.heic,.avif,.jpg,.jpeg"},{default:l(()=>[a("div",se,[o(v,{ref_key:"uploadRepairId",ref:y,style:{"font-size":"24px"},type:"primary",round:"",size:"large",icon:E(Y)},{default:l(()=>[p("上传图片")]),_:1},8,["icon"]),le])]),_:1})])],512),[[k,m.value]]),h(a("div",ne,[a("div",ie,[h((x(),G(U,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=L=>c.value=L),type:"card",style:{width:"100%"},"element-loading-background":"rgba(122, 122, 122, 0.5)"},{default:l(()=>[o(b,{name:"before",label:"修复前"},{default:l(()=>[a("div",re,[a("img",{src:w.value,style:{"max-width":"100%","max-height":"100%",display:"block"}},null,8,ce)])]),_:1}),o(b,{name:"after",label:"修复后"},{default:l(()=>[a("div",de,[a("img",{src:f.value,style:J({"max-width":"100%","max-height":"100%",display:"block","background-color":d.value})},null,12,pe)])]),_:1})]),_:1},8,["modelValue"])),[[V,u.value]]),o(v,{type:"primary",onClick:C,style:{position:"absolute",top:"5px",right:"0"},icon:E(Z)},{default:l(()=>[p("重新上传")]),_:1},8,["icon"])]),a("div",ue,[me,a("div",_e,[o(v,{onClick:S,type:"primary",round:"",size:"large",style:{"font-size":"20px",width:"150px"}},{default:l(()=>[p("下载")]),_:1})])])],512),[[k,!m.value]])])],64)}}});const Ve=X(fe,[["__scopeId","data-v-24e880a1"]]);export{Ve as default};
