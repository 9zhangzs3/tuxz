import{E as F}from"./index.f74eccca.js";import{E as L}from"./el-progress.dc5687d2.js";import{E as R,a as j}from"./el-tabs.06705e7e.js";import"./base.e040b817.js";/* empty css                  */import{v as D}from"./el-loading.764bfe53.js";import{d as N,r as a,k as b,l as A,z as f,A as x,m as o,q as i,s as l,B as k,v,E as O,C as P,x as q,y as M,_ as $}from"./entry.b15f9cd9.js";import{p as G,u as H}from"./constants.0fb4eb89.js";import{f as J}from"./util.a9abac9b.js";import"./index.fb1b8b13.js";import"./use-global-config.55fa202e.js";import"./use-form-common-props.5502e3a8.js";import"./index.f8748455.js";import"./error.78e43d3e.js";import"./aria.60e0cdc6.js";import"./event.9519ab40.js";import"./vnode.bca66073.js";const h=r=>(q("data-v-46216d4b"),r=r(),M(),r),K={style:{width:"90%",margin:"0 auto"}},Q={style:{width:"60%",margin:"0 auto","margin-top":"15%"}},W=h(()=>o("div",{style:{"font-size":"24px",height:"50px"}},"黑白图片变彩色",-1)),X={style:{"margin-top":"10%","font-size":"24px"}},Y=h(()=>o("div",{style:{color:"black"}},"或者拖放一个文件",-1)),Z={style:{width:"80%",margin:"0 auto","margin-top":"10%"}},ee={style:{float:"left",width:"45%",position:"relative"}},te={class:"cutout-image-container"},oe=["src"],ae={class:"cutout-image-container"},se=["src"],le={style:{float:"right",width:"45%",height:"442px",margin:"0 auto"}},ie=h(()=>o("div",{style:{height:"400px"}},null,-1)),ne={style:{width:"100%",margin:"0 auto"}},re=N({__name:"color",setup(r){const p=a(!0),c=a("before"),u=a(!0),E=a(),m=a(),g=a(),_=a(),d=a(""),w=a(),B=async t=>{p.value=!0,c.value="before",d.value="",E.value=t.raw,u.value=!1,g.value=await J(t.raw),await I(t.raw)},I=async t=>{m.value=t;const e=new FormData;e.append("file",t);const n=await(await fetch("http://124.220.44.98:5001/api/colorize",{method:"POST",body:e})).blob();_.value=URL.createObjectURL(n),p.value=!1,c.value="after"},z=t=>{const e=document.createElement("a");e.href=t,e.download=m.value.name,e.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0,view:window})),setTimeout(()=>{e.remove()},100)},C=()=>{var t=new Image;t.src=_.value;let e=document.createElement("canvas"),s=e.getContext("2d");t.onload=()=>{e.width=t.width,e.height=t.height,d&&(s.fillStyle=d.value),s.fillRect(0,0,e.width,e.height),s.drawImage(t,0,0);var n=e.toDataURL(m.value.type);z(n)}},S=()=>{var t,e;(e=(t=w.value)==null?void 0:t.$.vnode.el)==null||e.click()};return(t,e)=>{const s=F,n=L,y=R,T=j,U=D;return b(),A("div",K,[f(o("div",Q,[W,o("div",null,[i(n,{class:"upload-demo",drag:"","show-file-list":!1,"auto-upload":!1,onChange:B,accept:".gif,.tif,.tiff,.png,.crw,.cr2,.dng,.raf,.nef,.nrw,.orf,.rw2,.pef,.arw,.srf,.sr2,.raw,.psd,.svg,.webp,.heic,.avif,.jpg,.jpeg"},{default:l(()=>[o("div",X,[i(s,{ref_key:"uploadColorId",ref:w,style:{"font-size":"24px"},type:"primary",round:"",size:"large",icon:k(G)},{default:l(()=>[v("上传图片")]),_:1},8,["icon"]),Y])]),_:1})])],512),[[x,u.value]]),f(o("div",Z,[o("div",ee,[f((b(),O(T,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=V=>c.value=V),type:"card",style:{width:"100%"},"element-loading-background":"rgba(122, 122, 122, 0.5)"},{default:l(()=>[i(y,{name:"before",label:"修复前"},{default:l(()=>[o("div",te,[o("img",{src:g.value,style:{"max-width":"100%","max-height":"100%",display:"block"}},null,8,oe)])]),_:1}),i(y,{name:"after",label:"修复后"},{default:l(()=>[o("div",ae,[o("img",{src:_.value,style:P({"max-width":"100%","max-height":"100%",display:"block","background-color":d.value})},null,12,se)])]),_:1})]),_:1},8,["modelValue"])),[[U,p.value]]),i(s,{type:"primary",onClick:S,style:{position:"absolute",top:"5px",right:"0"},icon:k(H)},{default:l(()=>[v("重新上传")]),_:1},8,["icon"])]),o("div",le,[ie,o("div",ne,[i(s,{onClick:C,type:"primary",round:"",size:"large",style:{"font-size":"20px",width:"150px"}},{default:l(()=>[v("下载")]),_:1})])])],512),[[x,!u.value]])])}}});const Ie=$(re,[["__scopeId","data-v-46216d4b"]]);export{Ie as default};
